@namespace dmf_music_platform.Web.Components

<div class="card-container">
    <div class="flex justify-between items-center mb-8">
        <h2 class="text-2xl font-bold">Confirm & Deliver</h2>
        <button class="px-4 py-2 bg-gray-700 rounded hover:bg-gray-600" @onclick="OnBack">‚Üê Back</button>
    </div>

    @if (!submitted)
    {
        <div class="space-y-6 max-w-2xl">
            <div class="p-6 bg-blue-950 border border-blue-700 rounded-lg">
                <h3 class="text-lg font-bold mb-2">Release Summary</h3>
                <ul class="space-y-2 text-blue-300">
                    <li>‚Ä¢ <strong>Type:</strong> @(ReleaseType.ToUpper())</li>
                    <li>‚Ä¢ <strong>Status:</strong> Ready for global distribution</li>
                    <li>‚Ä¢ <strong>Delivery:</strong> All DSPs (Spotify, Apple Music, Amazon, SoundCloud, YouTube)</li>
                </ul>
            </div>

            <div class="p-6 bg-gray-900 border border-gray-700 rounded-lg">
                <label class="flex items-start gap-3 cursor-pointer">
                    <input type="checkbox" class="w-5 h-5 mt-1" @bind="agreeToTerms" />
                    <span class="text-sm">I agree that this release complies with all DMF and DSP requirements. I own or have rights to all content.</span>
                </label>
            </div>

            <div class="flex gap-4 pt-6">
                <button class="flex-1 px-4 py-3 bg-gray-700 rounded hover:bg-gray-600" @onclick="OnBack">‚Üê Back</button>
                <button class="flex-1 px-4 py-3 bg-green-600 text-white rounded font-bold hover:bg-green-700 disabled:opacity-50"
                    disabled="@(!agreeToTerms)" @onclick="Submit">
                    üöÄ Deliver Now
                </button>
            </div>
        </div>
    }
    else
    {
        <div class="text-center py-12">
            <div class="text-6xl mb-6">üéâ</div>
            <h3 class="text-2xl font-bold mb-4">Release Delivered!</h3>
            <p class="text-gray-300 mb-8">Your release is now queued for distribution across all global DSPs.</p>
            
            <div class="p-6 bg-green-950 border border-green-700 rounded-lg mb-8">
                <p class="text-green-300 font-bold mb-2">Delivery ID: #@deliveryId</p>
                <p class="text-green-200 text-sm">You'll receive email updates as your release goes live on each platform.</p>
            </div>

            <button class="px-6 py-3 bg-blue-600 text-white rounded font-bold hover:bg-blue-700" @onclick="Complete">
                ‚Üê Back to Dashboard
            </button>
        </div>
    }
</div>

@code {
    [Parameter]
    public string ReleaseType { get; set; } = "single";

    [Parameter]
    public EventCallback OnComplete { get; set; }

    [Parameter]
    public EventCallback OnBack { get; set; }

    private bool agreeToTerms = false;
    private bool submitted = false;
    private string deliveryId = "";

    private async Task Submit()
    {
        submitted = true;
        deliveryId = Guid.NewGuid().ToString().Substring(0, 8).ToUpper();
        await Task.Delay(1500);
    }

    private async Task Complete()
    {
        await OnComplete.InvokeAsync();
    }
}
